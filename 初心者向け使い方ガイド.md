# 軌道復元システム - 使い方ガイド

## このアプリの目的

このアプリは、鉄道の**レールの状態を分析・改善する**ためのツールです。

鉄道のレールは長年使用すると少しずつ歪んだり、凹凸ができてしまいます。この凹凸のことを「軌道狂い」と呼びます。軌道狂いが大きくなると、電車の乗り心地が悪くなったり、安全性に問題が出たりします。

このシステムでは、レールの測定データをグラフで見やすく表示し、さらに**データを滑らかに補正する**ことで、より正確な軌道の状態を把握できるようにします。

---

## できること

### 1. 軌道データの可視化
- CSVファイル形式の測定データを読み込み
- 距離ごとの軌道狂い量をグラフで表示
- データの統計情報(最小値、最大値、平均値など)を確認

### 2. データの復元処理
- ノイズ(測定の誤差や細かいブレ)を除去
- 移動平均フィルタで波形を滑らかに補正
- 元データと復元データを比較して確認

### 3. データの分析
- 軌道狂いの傾向を視覚的に把握
- 統計値で全体の状態を数値で確認
- どの区間に問題があるかを特定

---

## 使い方の手順

### ステップ1: データファイルの準備

軌道測定データをCSVファイルで用意します。

**ファイル形式:**
```
0.0,2.5
0.5,2.8
1.0,3.2
1.5,3.8
2.0,4.5
...
```

- **1列目**: 測定地点の距離(メートル単位)
- **2列目**: その地点の軌道狂い量(ミリメートル単位)

※ このアプリに含まれる `sample-data.csv` をサンプルとして使用できます

### ステップ2: データのアップロード

1. アプリを開くと「データアップロード」セクションが表示されます
2. **「ファイルを選択」ボタン**をクリック
3. 用意したCSVファイルを選択
4. ファイルが読み込まれると以下が自動的に表示されます:
   - ファイル名
   - データ点数(測定地点の数)
   - 軌道波形グラフ(青色の線)
   - 統計情報(最小・最大・平均・標準偏差)

### ステップ3: グラフでデータを確認

**軌道波形データ**セクションにグラフが表示されます。

- **横軸**: 距離(m) - レールのどの位置か
- **縦軸**: 軌道狂い量(mm) - レールの歪みの大きさ
- **青色の線**: アップロードした元データ

グラフを見ることで、どの区間でレールが大きく歪んでいるかが一目で分かります。

### ステップ4: 統計情報の確認

**統計情報**セクションで以下の値を確認できます:

- **最小値**: 最もレールの状態が良い地点の狂い量
- **最大値**: 最もレールの状態が悪い地点の狂い量
- **平均値**: 全体の平均的な狂い量
- **標準偏差**: データのばらつき(大きいほど区間によって差が大きい)

### ステップ5: 波形の復元(補正処理)

測定データには細かいノイズ(誤差)が含まれていることがあります。より正確な軌道の状態を知るために、データを滑らかに補正します。

1. **「波形を復元」ボタン**をクリック
2. システムが移動平均フィルタを適用して処理を実行
3. 処理が完了すると:
   - グラフに**赤色の線**(復元データ)が追加表示されます
   - 統計情報に「復元データ」の欄が追加されます

### ステップ6: 元データと復元データの比較

グラフには2本の線が表示されます:

- **青色の線**: 元の測定データ(細かい変動を含む)
- **赤色の線**: 復元データ(滑らかに補正されたデータ)

この2つを比較することで:
- 本当の軌道の傾向(大きな波形)が分かる
- 測定ノイズと実際の問題を区別できる
- より正確な保守計画を立てられる

---

## 画面の見方

### データアップロードセクション
ファイルを選択してデータを読み込むエリアです。

### 軌道波形データセクション
距離と軌道狂い量の関係をグラフで表示します。
- マウスでグラフにカーソルを合わせると、その地点の正確な値が表示されます

### 統計情報セクション
データの統計的な特徴を数値で確認できます。
- 元データと復元データの統計値を並べて比較できます

---

## ご注意

- **対応ファイル形式**: CSVファイルのみ
- **データ形式**: 2列(距離, 軌道狂い量)のカンマ区切り
- **復元処理**: 簡易的な3点移動平均フィルタを使用
  - 各地点の値を、前後の値との平均で置き換えます
  - より高度なフィルタ処理が必要な場合は別途ご相談ください

---

## 活用例

### 保守計画の立案
- 軌道狂いが大きい区間を特定
- 優先的に補修すべき箇所を決定

### 軌道状態の記録
- 定期的に測定してデータを保存
- 時系列で軌道の劣化傾向を把握

### 補修効果の確認
- 補修前後のデータを比較
- 作業の効果を数値とグラフで確認
